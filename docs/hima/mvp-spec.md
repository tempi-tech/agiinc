# Hima（ヒマ）— MVP 仕様書

> PdM パク・ミンジュン | 2026-02-13 | ステータス: 承認済み（CEO カイ 2026-02-13）

## 概要

Hima は、AI への繰り返し作業を一括で処理するバッチ AI ワークスペースである。ユーザーは自分の AI API キー（BYOK）を使い、プロンプトテンプレート（レシピ）を作成し、大量の入力を一括処理して結果をエクスポートできる。

**サービス名**: Hima（ヒマ / 暇）
**ドメイン**: hima.agiinc.io
**タグライン**: 「AIに仕事を丸投げして、ヒマになろう。」

## ターゲットユーザーと解決する課題

### ターゲット

AI を日常的に活用するプロシューマー。具体的には:

- **マーケター**: 大量の商品説明・広告コピーを AI で作成する人
- **コンテンツクリエイター**: ブログ記事、SNS 投稿、メルマガを量産する人
- **リサーチャー**: 論文・記事の要約、データ抽出を AI で効率化する人
- **デベロッパー**: コードレビュー、ドキュメント生成を AI に任せる人

### 課題

AI チャットツール（ChatGPT、Claude）は 1 対 1 の対話に優れているが、以下の課題がある:

1. **繰り返しの非効率** — 50 件の商品説明を書くのに、50 回プロンプトをコピペする必要がある。これは「人間がやるべきでない作業」の典型
2. **プロンプト管理の散逸** — 良いプロンプトを作っても、保存・再利用の仕組みがない。毎回ゼロから書く
3. **モデル選択の不透明さ** — どのモデルが自分のタスクに最適か比較する手段がなく、なんとなく 1 つのモデルを使い続ける
4. **プライバシーの懸念** — 多くのツールがサーバーサイドでデータを処理する。業務データがどこに保存されるか不明

### Hima の解決策

- レシピを一度作れば、何百件でも一括処理。人間はボタンを押すだけ
- レシピライブラリで蓄積・再利用
- BYOK で複数プロバイダのモデルを横断利用
- 完全クライアントサイド処理。API キーもデータもブラウザの外に出ない

## 機能一覧（MVP スコープ）

### MVP に含める機能

| # | 機能 | 説明 | 優先度 |
|---|---|---|---|
| F1 | API キー管理 | OpenAI, Anthropic, Google の API キーを登録・管理。localStorage に保存 | P0 |
| F2 | レシピエディタ | `{{変数名}}` 構文でプロンプトテンプレートを作成・編集 | P0 |
| F3 | バッチ実行 | CSV アップロードまたはテキスト貼り付けで複数入力を一括処理 | P0 |
| F4 | リアルタイム進捗 | 処理状況をプログレスバー + 件数で表示 | P0 |
| F5 | 結果テーブル | 入力→出力の対応をテーブル形式で表示。各行の展開可能 | P0 |
| F6 | CSV エクスポート | 結果を CSV ファイルとしてダウンロード | P0 |
| F7 | モデル選択 | 対応プロバイダからモデルを選択して実行 | P0 |
| F8 | レシピ保存 | 作成したレシピを localStorage に保存・一覧表示・再利用 | P1 |
| F9 | パラメータ設定 | temperature, max_tokens 等のモデルパラメータ調整 | P1 |
| F10 | テスト実行 | バッチ前にレシピを 1 件だけテスト実行して結果確認 | P1 |
| F11 | バッチキャンセル | 実行中のバッチ処理を中断 | P1 |
| F12 | エラーリトライ | 失敗した行のみを再実行 | P2 |

### MVP に含めない機能（将来検討）

- ユーザー認証・ログイン
- サーバーサイドのデータ保存・同期
- レシピの共有・公開マーケットプレイス
- レシピのチェーン（ワークフロー）
- スケジュール実行・定期バッチ
- モデル比較ビュー（サイドバイサイド出力比較）
- チーム機能・コラボレーション
- モバイル対応

## ユーザーストーリー

### US1: API キーの登録

> AI ツールを使いたいプロシューマーとして、自分の OpenAI API キーを登録したい。それにより、自分のアカウントの API を使って AI 処理ができるようになる。

受入条件:

- 設定画面で API キーを入力できる
- OpenAI, Anthropic, Google AI の 3 プロバイダに対応
- キーは localStorage に保存される
- 登録後にキーの疎通確認（簡易 API コール）ができる
- キーの更新・削除ができる
- キーはマスク表示される（`sk-●●●●...proj`）

### US2: レシピの作成

> マーケターとして、商品説明文を生成するプロンプトテンプレートを作りたい。それにより、商品データを流し込むだけで説明文を量産できる。

受入条件:

- プロンプト入力欄に `{{商品名}}` `{{カテゴリ}}` のような変数を記述できる
- 変数はリアルタイムで自動検出され、画面にリスト表示される
- 使用するモデルを選択できる
- レシピに名前を付けて保存できる
- 保存したレシピを一覧から選択してエディタにロードできる

### US3: バッチ実行

> 100 件の商品データを持つマーケターとして、CSV をアップロードして一括処理したい。それにより、100 回のコピペ作業から解放される。

受入条件:

- CSV ファイルをドラッグ＆ドロップまたはファイル選択でアップロードできる
- テキストをタブ区切り or 改行区切りで貼り付けて入力もできる
- CSV のカラムをレシピの変数にマッピングする UI がある
- 入力件数と推定処理時間が表示される
- 「バッチ実行」ボタンで全件の処理が開始される
- 処理中はプログレスバーと完了件数がリアルタイム更新される
- 処理中にキャンセルできる（未処理の件は実行されない）
- エラーが発生した行はスキップされ、ステータス列に表示される

### US4: 結果の確認とエクスポート

> バッチ処理が完了した後、結果を確認して CSV でダウンロードしたい。それにより、スプレッドシートや他のツールに結果を取り込める。

受入条件:

- 入力と出力が対になったテーブルが表示される
- 各行をクリックすると出力全文が展開表示される
- 処理ステータス（完了 / エラー / スキップ）が行ごとに表示される
- 「CSV でエクスポート」ボタンで全結果をダウンロードできる
- エクスポートには入力カラムと出力カラムの両方が含まれる

### US5: レシピの再利用

> 過去に作った「商品説明ジェネレータ」レシピを呼び出して、新しい商品データで再実行したい。それにより、毎回プロンプトを書き直す手間がなくなる。

受入条件:

- 保存済みレシピの一覧が表示される
- レシピ名、使用モデル、変数の数、最終使用日時が一覧に表示される
- レシピを選択するとエディタにロードされる
- レシピの複製・削除ができる

## 画面構成

### S1: ワークスペース画面（メイン画面）

アプリのメイン画面。左にレシピエディタ、右に入力・実行エリア、下部に結果テーブルの 3 パネル構成。

```
┌──────────────────────────────────────────────────────────┐
│  Hima                              [レシピ一覧] [設定⚙]  │
├─────────────────────────┬────────────────────────────────┤
│                         │                                │
│  レシピエディタ          │  入力 & 実行                    │
│                         │                                │
│  レシピ名: [___________]│  入力方式: [CSV] [テキスト]      │
│                         │                                │
│  モデル: [gpt-4o    ▼]  │  ┌──────────────────────────┐  │
│  Temp:  [0.7       ▼]  │  │                          │  │
│                         │  │  CSV ファイルをドロップ    │  │
│  プロンプト:             │  │  またはクリックで選択      │  │
│  ┌─────────────────┐   │  │                          │  │
│  │あなたはプロの     │   │  └──────────────────────────┘  │
│  │コピーライターです。│   │                                │
│  │                  │   │  変数マッピング:                │
│  │{{商品名}} の      │   │  {{商品名}}   → [カラムA ▼]    │
│  │魅力的な説明文を   │   │  {{カテゴリ}} → [カラムB ▼]    │
│  │150字以内で       │   │                                │
│  │書いてください。   │   │  入力件数: 100件                │
│  └─────────────────┘   │                                │
│                         │  [テスト実行(1件)] [バッチ実行]  │
│  検出された変数:         │                                │
│  商品名, カテゴリ        │                                │
│                         │                                │
│  [保存]                 │                                │
├─────────────────────────┴────────────────────────────────┤
│                                                          │
│  結果                                     [CSV エクスポート] │
│  ┌────┬───────────┬───────────────────┬────────┐        │
│  │ #  │ 商品名     │ 出力              │ 状態   │        │
│  ├────┼───────────┼───────────────────┼────────┤        │
│  │  1 │ AIスピー.. │ この革新的な...    │ ✅ 完了 │        │
│  │  2 │ スマート.. │ (処理中...)       │ ⏳ 処理中│        │
│  │  3 │ ワイヤレ.. │                   │ ⏸ 待機  │        │
│  └────┴───────────┴───────────────────┴────────┘        │
│                                                          │
│  進捗: ████████░░░░░ 42/100 完了 (42%)                    │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### S2: レシピライブラリ（モーダル）

保存済みレシピの一覧。選択でエディタにロードする。

```
┌──────────────────────────────────────┐
│  レシピライブラリ                 [×] │
├──────────────────────────────────────┤
│                                      │
│  ┌──────────────────────────────┐   │
│  │ 商品説明文ジェネレータ         │   │
│  │ gpt-4o | 変数: 2 | 2時間前   │   │
│  │ [使用] [複製] [削除]          │   │
│  └──────────────────────────────┘   │
│                                      │
│  ┌──────────────────────────────┐   │
│  │ メール要約                    │   │
│  │ claude-sonnet-4-5 | 変数: 1 | 1日前 │   │
│  │ [使用] [複製] [削除]          │   │
│  └──────────────────────────────┘   │
│                                      │
│  ┌──────────────────────────────┐   │
│  │ 記事タイトル案                 │   │
│  │ gemini-2.0-flash | 変数: 1 | 3日前 │   │
│  │ [使用] [複製] [削除]          │   │
│  └──────────────────────────────┘   │
│                                      │
└──────────────────────────────────────┘
```

### S3: 設定画面（モーダル）

API キーの登録・管理。

```
┌──────────────────────────────────────┐
│  設定                            [×] │
├──────────────────────────────────────┤
│                                      │
│  API キー                            │
│                                      │
│  OpenAI                              │
│  [sk-●●●●●●●●●●proj...  ] [✓ 接続済] │
│  [更新] [削除]                        │
│                                      │
│  Anthropic                           │
│  [未設定                    ]         │
│  [キーを追加]                         │
│                                      │
│  Google AI                           │
│  [未設定                    ]         │
│  [キーを追加]                         │
│                                      │
│  ──────────────────────              │
│                                      │
│  データ管理                           │
│  [全データをエクスポート]              │
│  [全データを削除]                     │
│                                      │
└──────────────────────────────────────┘
```

### 画面遷移

```
[初回アクセス]
    │
    ▼
  S3: 設定（API キー登録を促す）
    │
    ▼
  S1: ワークスペース（メイン画面）
    ├── [レシピ一覧] → S2: レシピライブラリ → [使用] → S1 にロード
    ├── [設定⚙] → S3: 設定
    ├── [テスト実行] → S1 下部に 1 件の結果表示
    └── [バッチ実行] → S1 下部に進捗 + 結果テーブル表示
```

## 技術的な制約・前提

### アーキテクチャ

- **フロントエンド**: SPA（Single Page Application）
- **バックエンド**: なし（完全クライアントサイド）。ただし CORS プロキシが必要（後述）
- **デプロイ**: 静的サイトホスティング（Cloudflare Pages 推奨）
- **ドメイン**: hima.agiinc.io

### CORS プロキシについて（CTO 要協議）

主要 AI プロバイダの API はブラウザからの直接リクエスト（CORS）を許可していない。以下のいずれかで対応が必要:

- **案 A（推奨）**: Cloudflare Worker を CORS プロキシとして配置。リクエストをそのまま転送し CORS ヘッダを付与するだけ。データ保存は一切しない
- **案 B**: 各プロバイダの CORS 対応状況を調査し、対応しているプロバイダはダイレクト接続

技術選定は CTO（アレクセイ）に委ねる。

### データ保存

| データ | 保存先 | 永続性 |
|---|---|---|
| API キー | localStorage | ブラウザに永続 |
| レシピ | localStorage / IndexedDB | ブラウザに永続 |
| バッチ結果 | メモリ（変数） | タブを閉じると消失 |

- **ユーザーのデータは一切サーバーに送信しない**（CORS プロキシはリクエストを転送するのみ）
- 結果はメモリ上のみ。エクスポートしないと消失する旨を UI で明示する

### AI API 連携

| プロバイダ | API | 対応モデル（MVP） |
|---|---|---|
| OpenAI | Chat Completions API | gpt-4o, gpt-4o-mini |
| Anthropic | Messages API | claude-sonnet-4-5, claude-haiku-4-5 |
| Google | Generative Language API | gemini-2.0-flash |

### バッチ処理の制御

- 同時実行数: 最大 5 並列リクエスト（プロバイダのレートリミット考慮）
- リトライ: 429 / 5xx エラー時に指数バックオフで最大 3 回
- キャンセル: AbortController による実行中リクエストの中断

### 認証

- MVP ではログイン不要
- 全データがブラウザローカルに閉じるため、認証なしでも機能する

### ブラウザ対応

- Chrome, Edge, Firefox, Safari の最新版
- デスクトップ優先。モバイル対応は MVP スコープ外

## 成功指標

### 定量指標（ローンチ後 1 ヶ月目標）

| 指標 | 目標値 |
|---|---|
| ページ訪問者数（UV） | 1,000 |
| API キー登録完了率 | 訪問者の 30% |
| バッチ実行回数 | 500 回 |
| レシピ保存数 | 200 件 |
| 週次アクティブユーザー（WAU） | 100 人 |

### 定性指標

- X / Twitter でのポジティブな言及
- 「また使いたい」「これが欲しかった」というフィードバック
- AI コミュニティ（Reddit, Hacker News 等）での自然発生的な共有

## 参考: 想定開発スケジュール

| 週 | 内容 |
|---|---|
| W08 (2/17-23) | プロジェクトセットアップ、UI フレームワーク、基本レイアウト、API キー管理 |
| W09 (2/24-3/2) | レシピエディタ（変数自動検出）、シングルテスト実行、モデル選択 |
| W10 (3/3-9) | バッチ処理エンジン、進捗表示、結果テーブル |
| W11 (3/10-16) | CSV 入出力、レシピライブラリ、パラメータ設定 |
| W12 (3/17-23) | テスト、バグ修正、UI ポリッシュ |
| W13 (3/24-31) | デプロイ、ランディングページ、パブリックリリース |

※ スケジュールは四半期計画のマイルストーンに準拠。詳細は CTO・Engineer と協議の上調整する。
